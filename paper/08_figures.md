\clearpage

# Figures

## Figure 1 {#fig1}

![**Adaptation and the Evolution of Cooperation.** The average cooperator proportion among replicate populations for the duration of simulations are shown as curves, and shaded areas indicate 95% confidence intervals. (**A**) Without any opportunity to adapt ($L=0$), cooperation is quickly lost. (**B**) When adaptation can occur ($L=5$, $\delta=0.3$), but niche construction does not affect selection ($\epsilon=0$), cooperators rise in abundance by hitchhiking along with adaptions to the external environment. Nevertheless, this effect is transient, and defectors eventually dominate. (**C**) Feedbacks from niche construction ($\epsilon=0.00015$) enable cooperation to be maintained in the majority of populations. Figure 2A shows the individual trajectories of these populations.](../figures/Figure1.png)

\clearpage


## Figure 2 {#fig2}

![**Niche Construction and the Evolution of Cooperation.** The proportion of cooperators present in each replicate population is shown for the duration of simulations. (**A**) Despite some oscillation, cooperators dominate in 13 of 18 populations when niche construction affects selection. (**B**) When the selective effects of niche construction are transferred to supplement the benefits conferred by adaptation to the external, non-constructed environment, cooperators are driven to extinction by defectors (replacing $S_{max} \times \epsilon=0.3$, $\delta=0.3$ with $\epsilon=0$, $\delta=0.6$). Note that cooperation was not present after initialization in one replicate population. (**C**) Cooperators are also driven to extinction without negative niche construction ($A=5$).](../figures/Figure2.png)

\clearpage


## Figure 3 {#fig3}

![**Niche Construction and Invasion.** The proportion of cooperators present in each replicate population is shown for the duration of simulations ($T=1000$). In each simulation, a rare type was initiated at a single patch in the center of the population lattice ($N^{2}=121$). Unless otherwise noted, mutations are disabled in these ecological simulations to highlight the dynamics of invasion ($\mu_{a}=0, \mu_{c}=0$). (**A**) When cooperators and defectors are isogenic (i.e., both types have adaptive alleles [1,2,3,4,5]), rare defectors quickly invade and drive cooperators to extinction due to the cost of cooperation. Note that defectors were stochastically eliminated in two replicate populations. (**B**) However, when populations can adapt, negative niche construction creates adaptive opportunities that enable cooperators to resist invasion by isogenic defectors. When adaptive mutations occur ($\mu_{a}=0.00005$), cooperation remained dominant in 91 of 160 populations. Results from simulations where mutations also occurred at the cooperation locus are shown in Figure S8. (**C**) In fact, a cooperator (adaptive alleles [6,2,3,4,5], see Box 1) that is adapted to the niche constructed by the defectors can swiftly displace defectors.](../figures/Figure3.png)

\clearpage


## Figure 4 {#fig4}

![**Cooperator Adaptation Prevents Defector Invasion.** The spatial distribution of dominant types within each subpopulations is shown at different time points for one representative simulation in which isogenic defectors arise. To highlight the effects of adaptation, mutations did not occur at the cooperation locus ($\mu_{c}=0$). At time $t=0$ (upper left panel), a single isogenic defector subpopulation (red) is placed within an all-cooperator population (light blue). Because these defectors do not bear the cost of cooperation, they quickly spread ($t=272$). However, cooperators in one subpopulation gain an adaptation that gives them a fitness advantage over defectors (second panel, medium blue, lower left). At $t=325$, defectors continue to invade cooperator subpopulations. However, the adapted cooperator type spreads more quickly due to its fitness advantage, invading both defector and ancestral cooperator subpopulations ($t=390$), until it eventually fixes in the population ($t=500$). At $t=690$, a new cooperator type emerges that is favored in the constructed niche (dark blue). This new type spreads rapidly ($t=812$) until reaching fixation ($t=900$). At this point, it becomes susceptible to invasion by the next "adapted" cooperator type, and the cycle continues.](../figures/Figure4.png)

\clearpage

## Figure 5 {#fig5}

![**Niche Construction and the Invasion of Cooperation.** The proportion of cooperators present in each of 50 replicate populations is shown for the duration of simulations ($T=5000$). Baseline parameters are used, except for $S_{max}=8000$, and the initial proportion of cooperators in each population is zero ($p_0=0$), which requires cooperators to arise via mutation. (**A**) Cooperators invade and reach very high proportions when niche construction affects selection (50 replicates shown). (**B**) Without niche construction ($\epsilon=0$), cooperators do not invade (50 replicates shown).](../figures/cooperator_invasion.png)


\clearpage


# Box 1 Figures
\renewcommand{\thefigure}{B\arabic{figure}}
\setcounter{figure}{0}

## Figure B1 {#figB1}

![Figure for Box 1](../figures/FigureB1.pdf)

